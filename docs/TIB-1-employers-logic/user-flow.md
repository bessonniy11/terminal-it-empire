# User Flow — TIB-1

## 1. Загрузка игры
1. Игрок открывает страницу, приложение считывает состояние из `localStorage`. 
2. Если сохранения нет, инициируется стандартное начальное состояние (деньги, сотрудники, проекты, экономика).
3. UI синхронизируется с состоянием (панели, терминал, модалки скрыты).

## 2. Найм сотрудника
1. Игрок открывает панель «Нанять сотрудника». Все карточки показывают актуальную стоимость (учёт инфляции) и текущую «рыночную» зарплату.
2. При клике на доступную карточку списываются деньги, создаётся сотрудник со сгенерированным «трендом» поведения, историей событий и зарплатой.
3. В терминале отображается сообщение о найме; состояние моментально сохраняется в `localStorage`.

## 3. Еженедельный цикл
1. Игрок нажимает `Next Week`.
2. Списываются зарплаты (по `currentSalary`) и начисляются очки прогресса проектов.
3. Для каждого активного сотрудника случайная логика определяет событие недели:
   - **Позитивное** — заказчик платит бонус, репутация/деньги растут, в историю добавляется запись.
   - **Негативное** — штраф/неустойка, репутация падает, запись добавляется.
   - **Нейтральное** — ничего не происходит.
4. После событий обновляется удовлетворённость сотрудника: учитываем отношение `currentSalary/marketSalary`, тренд, количество последних хороших/плохих недель.
5. Если удовлетворённость падает ниже порога, с вероятностью 70 % формируется предупреждение об уходе (с разными текстами источника). Предупреждения отображаются всплывающей модалкой и в терминале.
6. Если предупреждение игнорируется N недель или сотрудник системно недоволен, он увольняется (иногда без предупреждения). В модалке и терминале фиксируется причина.
7. Завершение проекта приносит деньги (учёт инфляции) и репутацию.
8. По окончании цикла состояние сохраняется в `localStorage`.

## 4. Работа с модалкой сотрудника
1. В блоке «Нанятые сотрудники» у каждой карточки есть кнопка «Статистика».
2. По клику открывается модалка:
   - список событий (цветом разделены позитивные/негативные/системные);
   - текущая зарплата, рыночная зарплата, настроение, активные предупреждения;
   - numeric input зарплаты.
3. Игрок может изменить зарплату:
   - проверяем доступный бюджет; 
   - записываем событие «повышена/понижена зарплата»; 
   - пересчитываем удовлетворённость.
4. Сохранение закрывает модалку и обновляет состояние/`localStorage`.

## 5. Инфляция и экономика
1. Каждые `economy.inflationInterval` недель:
   - `salaryScale` и `projectScale` умножаются на фиксированный коэффициент (примерно 5 %).
   - Новые сотрудники стоят дороже, и рыночная зарплата подскакивает.
   - Награды проектов также растут, чтобы экономика была сбалансированной.
2. Событие инфляции логируется в терминал.

## 6. Увольнение и последствия
1. При увольнении сотрудник удаляется из state.
2. Если увольнение было внезапным (30 % случаев), игрок видит сообщение «получил новый оффер» и т.п.
3. Завершение фиксируется в истории сотрудника (если есть сохранение) и в терминале.
4. Состояние сохраняется; если после увольнения не осталось людей для проекта, прогресс замедляется как и раньше.

## 7. Завершение игры
- Условия победы/поражения остаются прежними (деньги или репутация). Системные модалки по сотрудникам не мешают триггеру конца игры.

## 8. Работа с сохранениями
1. После каждого изменения state вызывается `saveState()` (дебаунс или прямой вызов).
2. При загрузке `loadState()` валидирует данные (версия схемы, дефолтные значений для новых полей).
3. Предусматривается кнопка сброса (команда `reset`) — очищает `localStorage` и создаёт новое состояние.
