# User Flow — TIB-1

## 1. Старт игры
1. Игрок открывает страницу, игра читает сохранение из `localStorage`.
2. Если сохранения нет, создаётся стандартное состояние (деньги, сотрудники, проекты, экономика).
3. UI синхронизируется со state (панели, терминал, модалки скрыты).

## 2. Найм сотрудника
1. Игрок открывает панель «Нанять сотрудника». Карточки показывают актуальную стоимость и рыночную зарплату (учёт инфляции).
2. При найме создаётся сотрудник со случайным профилем:
   - джуны имеют 50/50 шанс быть «аккуратными» либо «косячными» (`lowExpectations`), у каждого задаются `positiveBias/negativeBias`, `learningRate`, `growth`;
   - профиль влияет на частоту событий, амбиции и склонность увольняться.
3. В терминале отображается сообщение о найме; state сохраняется.

## 3. Еженедельный цикл
1. Игрок нажимает `Next Week`.
2. Выплачиваются зарплаты (`currentSalary`) и начисляется прогресс проектов.
3. Для каждого сотрудника распределение событий использует его профиль:
   - **Позитивное** — бонусы денег/репутации, запись в истории.
   - **Негативное** — штрафы, запись в истории.
   - **Нейтральное** — ничего важного, но фиксируется в истории.
4. После событий обновляется настроение (`moodScore`): учитывается отношение `currentSalary/marketSalary`, тон события и недавние повышения.
5. Предупреждения: при низком настроении формируется предупреждение об уходе (для `lowExpectations` шанс сильно меньше).
6. **Карьера и амбиции**:
   - Сотрудники с флагом `growth` (в основном джуны и часть мидлов) каждые 10–15 успешных недель требуют повышения грейда.
   - Сначала приходит toast («хочу middle/senior») и запись в журнал. Если повышение игнорируется, появляется предупреждение «хочу расти». Через несколько недель возможен уход даже при высокой зарплате (≈35 % амбициозных сотрудников ведут себя так).
7. Если предупреждение (зарплатное или карьерное) игнорируется, либо настроение остаётся внизу, сотрудник увольняется (иногда без предупреждения). Терминал и история фиксируют причину. Для хронических косячников причины юмористические.
8. Завершение проектов приносит деньги/репутацию.
9. Инфляция: каждые `inflationInterval` недель `salaryScale` и `projectScale` умножаются на коэффициент (по умолчанию +5 %), пересчитываются рыночные зарплаты, в терминал выводится сообщение.
10. State сохраняется.

## 4. Работа с модалками
1. В «Нанятых сотрудниках» у каждой карточки есть кнопка «Статистика».
2. Модалка показывает: имя, роль, текущую/рыночную зарплату, настроение, предупреждения/карьерные запросы, историю событий.
3. Игрок может изменить зарплату (но не ниже 80 % рыночной). Ошибки отображаются под инпутом, запись фиксируется в истории.
4. Глобальная модалка «Team Status» показывает всех сотрудников (муд-чипы, предупреждения, кнопка «Подробно»). Открытие карточки не закрывает глобальную модалку.
5. Toast-уведомления (предупреждения, карьерные запросы, увольнения) отображаются в правом верхнем углу и исчезают автоматически.

## 5. Инфляция и экономика
1. `salaryScale` и `projectScale` растут каждые `inflationInterval` недель (на 5 % по умолчанию).
2. Карточки найма/проектов используют **актуальные** коэффициенты.
3. Рыночная зарплата сотрудника — `baseSalary * salaryScale`; при повышении оклада не меняется.

## 6. Увольнение
1. Увольнение (добровольное или принудительное) снимает сотрудника из state.
2. В 30 % случаев (по профилю) возможен внезапный уход (toast + запись).
3. История сотрудника хранит причину; терминал/уведомления показывают краткое сообщение.

## 7. Завершение игры
- Победа/проигрыш проверяется по банковскому счёту или репутации.
- При `gameOver` ввод команд блокируется, пока не выполнен `reset`.

## 8. Сохранения
1. Любое изменение вызывает `saveState()`.
2. `loadState()` проверяет и мигрирует новые поля (экономика, профили, предупреждения).
3. `reset` очищает `localStorage` и создаёт начальное состояние.
